use mysql;
create database assignment5;
use assignment5;
 
 create table Dept(
 DEPTNO int primary key,
 DNAME varchar(50),
 DLOC varchar(50));
 drop table EMPLOYEE;
 create table EMPLOYEE(
 EMPNO int primary key,
 ENAME varchar(50),
 MGR_NO INT,
 HIREDATE date,
 SAL int,
 DEPTNO int,
 foreign key(DEPTNO) references Dept(DEPTNO));

drop table INCENTIVES;
 create table INCENTIVES(
 INCENTIVE_DATE date,
 INCENTIVE_AMOUNT INT,
 EMPNO int,
 primary key(EMPNO, INCENTIVE_DATE),
foreign key(EMPNO) references EMPLOYEE(EMPNO));

create table project(
PNO int PRIMARY KEY,
PLOC varchar(50),
PNAME VARCHAR(50));

create table  ASSIGNED_TO(
EMPNO INT,
PNO INT,
JOB_ROLE VARCHAR(50),
PRIMARY KEY(EMPNO,PNO),
foreign key(EMPNO) references INCENTIVES( EMPNO),
foreign key(PNO) references  project(PNO));

INSERT INTO DEPT VALUES(1,'SALES','MYSORE');
INSERT INTO DEPT VALUES(2,'PRODUCTION','BANGALORE');
INSERT INTO DEPT VALUES(4,'SERVICE','BALLARI');
INSERT INTO DEPT VALUES(5,'DEVELOPMENT','MYSORE');
INSERT INTO DEPT VALUES(6,'RESEARCH','BALLARI');

SELECT * FROM DEPT;

INSERT INTO EMPLOYEE VALUES(100,'RAJ',10,'2003-05-01',5000,1);
INSERT INTO EMPLOYEE VALUES(101,'RAM',11,'2004-06-21',6000,2);
INSERT INTO EMPLOYEE VALUES(103,'RINKY',101,'2006-07-9',7000,4);
INSERT INTO EMPLOYEE VALUES(104,'ROSHAN',100,'2004-06-04',8000,5);
INSERT INTO EMPLOYEE VALUES(105,'REMO',13,'2001-09-09',3000,6);

INSERT INTO INCENTIVES VALUES('2006-08-07',300,100);
INSERT INTO INCENTIVES VALUES('2006-08-08',400,101);
INSERT INTO INCENTIVES VALUES('2006-08-09',500,103);
INSERT INTO INCENTIVES VALUES('2006-08-10',600,104);
INSERT INTO INCENTIVES VALUES('2006-08-11',700,105);

INSERT INTO PROJECT VALUES(20,'BANGALORE','PROJECT1');
INSERT INTO PROJECT VALUES(21,'BIJAPUR','PROJECT2');
INSERT INTO PROJECT VALUES(22,'BALLARI','PROJECT3');
INSERT INTO PROJECT VALUES(23,'MYSORE','PROJECT4');
INSERT INTO PROJECT VALUES(24,'RAICHUR','PROJECT5');
 
INSERT INTO ASSIGNED_TO VALUES (100,20,'SALESMAN');
INSERT INTO ASSIGNED_TO VALUES (101,21,'MANAGER');
INSERT INTO ASSIGNED_TO VALUES (103,23,'SALESMAN');
INSERT INTO ASSIGNED_TO VALUES (104,24,'SALESMAN');
INSERT INTO ASSIGNED_TO VALUES (105,22,'MANAGER');


// Retrieve all employees from the 'DEVELOPMENT' department.
SELECT * FROM EMPLOYEE WHERE DEPTNO = (SELECT DEPTNO FROM DEPT WHERE DNAME = 'DEVELOPMENT');

// List the names of employees who have received an incentive of more than 400.
SELECT E.ENAME
FROM EMPLOYEE E
JOIN INCENTIVES I ON E.EMPNO = I.EMPNO
WHERE I.INCENTIVE_AMOUNT > 400;

//  Find the total salary of each department.
SELECT D.DNAME, SUM(E.SAL) AS TOTAL_SALARY
FROM DEPT D
JOIN EMPLOYEE E ON D.DEPTNO = E.DEPTNO
GROUP BY D.DNAME;

//  Retrieve the project names along with the count of employees assigned to each project.
SELECT P.PNAME, COUNT(A.EMPNO) AS EMPLOYEE_COUNT
FROM PROJECT P
LEFT JOIN ASSIGNED_TO A ON P.PNO = A.PNO
GROUP BY P.PNAME;

//  Find the average incentive amount received by employees in the 'SALES' department.
SELECT AVG(I.INCENTIVE_AMOUNT) AS AVG_INCENTIVE_AMOUNT
FROM INCENTIVES I
JOIN EMPLOYEE E ON I.EMPNO = E.EMPNO
JOIN DEPT D ON E.DEPTNO = D.DEPTNO
WHERE D.DNAME = 'SALES';



